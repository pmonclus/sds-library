<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDS Library: Owner Helper Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SDS Library<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Simple DDS - Lightweight IoT State Synchronization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__owner__helpers.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Owner Helper Functions </div></div>
</div><!--header-->
<div class="contents">

<p>Utility functions for the owner role.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga002e756761a5c2dcd4389ab860247ded" id="r_ga002e756761a5c2dcd4389ab860247ded"><td class="memItemLeft">const void *&#160;</td><td class="memItemRight"><a class="el" href="#ga002e756761a5c2dcd4389ab860247ded">sds_find_node_status</a> (const void *owner_table, const char *table_type, const char *node_id)</td></tr>
<tr class="memdesc:ga002e756761a5c2dcd4389ab860247ded"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find status for a specific device (owner role only).  <br /></td></tr>
<tr class="memitem:gaf6b368bf2bb3267cee8db6c0fb1ef0ca" id="r_gaf6b368bf2bb3267cee8db6c0fb1ef0ca"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#gaf6b368bf2bb3267cee8db6c0fb1ef0ca">sds_foreach_node</a> (const void *owner_table, const char *table_type, <a class="el" href="group__callbacks.html#ga663545907da5cc9b3981185ffe824c52">SdsNodeIterator</a> callback, void *user_data)</td></tr>
<tr class="memdesc:gaf6b368bf2bb3267cee8db6c0fb1ef0ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterate over all known device nodes (owner role only).  <br /></td></tr>
<tr class="memitem:ga123fbc786143c83795b09d8332e18f71" id="r_ga123fbc786143c83795b09d8332e18f71"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga123fbc786143c83795b09d8332e18f71">sds_set_owner_status_slots</a> (const char *table_type, size_t slots_offset, size_t slot_size, size_t slot_status_offset, size_t count_offset, uint8_t max_slots)</td></tr>
<tr class="memdesc:ga123fbc786143c83795b09d8332e18f71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure status slot metadata for manual table registration.  <br /></td></tr>
<tr class="memitem:ga1f5ee7f7b53a65c266dee0a967683dd1" id="r_ga1f5ee7f7b53a65c266dee0a967683dd1"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#ga1f5ee7f7b53a65c266dee0a967683dd1">sds_set_owner_slot_offsets</a> (const char *table_type, size_t valid_offset, size_t online_offset, size_t last_seen_offset)</td></tr>
<tr class="memdesc:ga1f5ee7f7b53a65c266dee0a967683dd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure slot field offsets for online detection (owner role only).  <br /></td></tr>
<tr class="memitem:gabad46d1e7d411b2b7773e0248651fd5b" id="r_gabad46d1e7d411b2b7773e0248651fd5b"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#gabad46d1e7d411b2b7773e0248651fd5b">sds_set_owner_eviction_offsets</a> (const char *table_type, size_t eviction_pending_offset, size_t eviction_deadline_offset)</td></tr>
<tr class="memdesc:gabad46d1e7d411b2b7773e0248651fd5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure eviction slot offsets for an owner table.  <br /></td></tr>
<tr class="memitem:gae142a1929b1869cff9059e48b9d29d58" id="r_gae142a1929b1869cff9059e48b9d29d58"><td class="memItemLeft">bool&#160;</td><td class="memItemRight"><a class="el" href="#gae142a1929b1869cff9059e48b9d29d58">sds_is_device_online</a> (const void *owner_table, const char *table_type, const char *node_id, uint32_t timeout_ms)</td></tr>
<tr class="memdesc:gae142a1929b1869cff9059e48b9d29d58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a device is currently online (owner role only).  <br /></td></tr>
<tr class="memitem:gaf3bc5a746b96a07e311c4c24feb94127" id="r_gaf3bc5a746b96a07e311c4c24feb94127"><td class="memItemLeft">uint32_t&#160;</td><td class="memItemRight"><a class="el" href="#gaf3bc5a746b96a07e311c4c24feb94127">sds_get_liveness_interval</a> (const char *table_type)</td></tr>
<tr class="memdesc:gaf3bc5a746b96a07e311c4c24feb94127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the liveness interval for a table type.  <br /></td></tr>
<tr class="memitem:ga870e494e925171aef1c910118c3a2a8e" id="r_ga870e494e925171aef1c910118c3a2a8e"><td class="memItemLeft">uint32_t&#160;</td><td class="memItemRight"><a class="el" href="#ga870e494e925171aef1c910118c3a2a8e">sds_get_eviction_grace</a> (const char *table_type)</td></tr>
<tr class="memdesc:ga870e494e925171aef1c910118c3a2a8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the global eviction grace period.  <br /></td></tr>
<tr class="memitem:gaa960005296d3c78a174f8ff2031719fa" id="r_gaa960005296d3c78a174f8ff2031719fa"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#gaa960005296d3c78a174f8ff2031719fa">sds_on_device_evicted</a> (const char *table_type, <a class="el" href="group__callbacks.html#ga1620244dfc15a6423fe29b7d9c3edc3e">SdsDeviceEvictedCallback</a> callback, void *user_data)</td></tr>
<tr class="memdesc:gaa960005296d3c78a174f8ff2031719fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set global callback for device eviction notifications.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utility functions for the owner role. </p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga002e756761a5c2dcd4389ab860247ded" name="ga002e756761a5c2dcd4389ab860247ded"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga002e756761a5c2dcd4389ab860247ded">&#9670;&#160;</a></span>sds_find_node_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const void * sds_find_node_status </td>
          <td>(</td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>owner_table</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>node_id</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find status for a specific device (owner role only). </p>
<p>Looks up the status slot for a device by its node ID.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> SensorDataStatus* status = <a class="code hl_function" href="#ga002e756761a5c2dcd4389ab860247ded">sds_find_node_status</a>(&amp;owner_table, <span class="stringliteral">&quot;SensorData&quot;</span>, <span class="stringliteral">&quot;sensor_01&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (status) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Temperature: %.1f\n&quot;</span>, status-&gt;temperature);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__owner__helpers_html_ga002e756761a5c2dcd4389ab860247ded"><div class="ttname"><a href="#ga002e756761a5c2dcd4389ab860247ded">sds_find_node_status</a></div><div class="ttdeci">const void * sds_find_node_status(const void *owner_table, const char *table_type, const char *node_id)</div><div class="ttdoc">Find status for a specific device (owner role only).</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">owner_table</td><td>Pointer to owner table structure </td></tr>
    <tr><td class="paramname">table_type</td><td>Table type name </td></tr>
    <tr><td class="paramname">node_id</td><td>Node ID to find </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to status struct, or NULL if not found</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaf6b368bf2bb3267cee8db6c0fb1ef0ca" title="Iterate over all known device nodes (owner role only).">sds_foreach_node</a>, <a class="el" href="#gae142a1929b1869cff9059e48b9d29d58" title="Check if a device is currently online (owner role only).">sds_is_device_online</a> </dd></dl>

</div>
</div>
<a id="gaf6b368bf2bb3267cee8db6c0fb1ef0ca" name="gaf6b368bf2bb3267cee8db6c0fb1ef0ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf6b368bf2bb3267cee8db6c0fb1ef0ca">&#9670;&#160;</a></span>sds_foreach_node()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sds_foreach_node </td>
          <td>(</td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>owner_table</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__callbacks.html#ga663545907da5cc9b3981185ffe824c52">SdsNodeIterator</a></td>          <td class="paramname"><span class="paramname"><em>callback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>user_data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Iterate over all known device nodes (owner role only). </p>
<p>Calls the callback function once for each device that has sent status.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> print_node(<span class="keyword">const</span> <span class="keywordtype">char</span>* node_id, <span class="keyword">const</span> <span class="keywordtype">void</span>* status, <span class="keywordtype">void</span>* user_data) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Node: %s\n&quot;</span>, node_id);</div>
<div class="line">}</div>
<div class="line"><a class="code hl_function" href="#gaf6b368bf2bb3267cee8db6c0fb1ef0ca">sds_foreach_node</a>(&amp;owner_table, <span class="stringliteral">&quot;SensorData&quot;</span>, print_node, NULL);</div>
<div class="ttc" id="agroup__owner__helpers_html_gaf6b368bf2bb3267cee8db6c0fb1ef0ca"><div class="ttname"><a href="#gaf6b368bf2bb3267cee8db6c0fb1ef0ca">sds_foreach_node</a></div><div class="ttdeci">void sds_foreach_node(const void *owner_table, const char *table_type, SdsNodeIterator callback, void *user_data)</div><div class="ttdoc">Iterate over all known device nodes (owner role only).</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">owner_table</td><td>Pointer to owner table structure </td></tr>
    <tr><td class="paramname">table_type</td><td>Table type name </td></tr>
    <tr><td class="paramname">callback</td><td>Function to call for each node </td></tr>
    <tr><td class="paramname">user_data</td><td>User-provided context passed to callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__callbacks.html#ga663545907da5cc9b3981185ffe824c52" title="Iterator callback for sds_foreach_node().">SdsNodeIterator</a>, <a class="el" href="#ga002e756761a5c2dcd4389ab860247ded" title="Find status for a specific device (owner role only).">sds_find_node_status</a> </dd></dl>

</div>
</div>
<a id="ga870e494e925171aef1c910118c3a2a8e" name="ga870e494e925171aef1c910118c3a2a8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga870e494e925171aef1c910118c3a2a8e">&#9670;&#160;</a></span>sds_get_eviction_grace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t sds_get_eviction_grace </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the global eviction grace period. </p>
<p>Returns the eviction grace period configured in <a class="el" href="struct_sds_config.html" title="Configuration for SDS initialization.">SdsConfig</a>. After an LWT (device offline) message, the device has this long to reconnect before being evicted from all status tables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table_type</td><td>Ignored (kept for backward compatibility) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Eviction grace period in milliseconds, or 0 if eviction is disabled</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="struct_sds_config.html#a2bbfb685e4fd026e7be87e0f9352583f">SdsConfig::eviction_grace_ms</a> </dd></dl>

</div>
</div>
<a id="gaf3bc5a746b96a07e311c4c24feb94127" name="gaf3bc5a746b96a07e311c4c24feb94127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf3bc5a746b96a07e311c4c24feb94127">&#9670;&#160;</a></span>sds_get_liveness_interval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t sds_get_liveness_interval </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the liveness interval for a table type. </p>
<p>Returns the liveness interval (from @liveness in schema) for the given table. This is useful for calculating timeout values for <a class="el" href="#gae142a1929b1869cff9059e48b9d29d58" title="Check if a device is currently online (owner role only).">sds_is_device_online()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table_type</td><td>Table type name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Liveness interval in milliseconds, or 0 if not found</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gae142a1929b1869cff9059e48b9d29d58" title="Check if a device is currently online (owner role only).">sds_is_device_online</a> </dd></dl>

</div>
</div>
<a id="gae142a1929b1869cff9059e48b9d29d58" name="gae142a1929b1869cff9059e48b9d29d58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae142a1929b1869cff9059e48b9d29d58">&#9670;&#160;</a></span>sds_is_device_online()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sds_is_device_online </td>
          <td>(</td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>owner_table</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>node_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>timeout_ms</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a device is currently online (owner role only). </p>
<p>A device is considered online if all of the following are true:</p><ul>
<li>We have a valid status slot for it</li>
<li>The "online" flag is true (not cleared by LWT or graceful disconnect)</li>
<li>Last message was received within the specified timeout</li>
</ul>
<div class="fragment"><div class="line">uint32_t timeout = <a class="code hl_function" href="#gaf3bc5a746b96a07e311c4c24feb94127">sds_get_liveness_interval</a>(<span class="stringliteral">&quot;SensorData&quot;</span>) * 3 / 2;  <span class="comment">// 1.5Ã—</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="#gae142a1929b1869cff9059e48b9d29d58">sds_is_device_online</a>(&amp;owner_table, <span class="stringliteral">&quot;SensorData&quot;</span>, <span class="stringliteral">&quot;sensor_01&quot;</span>, timeout)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Device is online\n&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__owner__helpers_html_gae142a1929b1869cff9059e48b9d29d58"><div class="ttname"><a href="#gae142a1929b1869cff9059e48b9d29d58">sds_is_device_online</a></div><div class="ttdeci">bool sds_is_device_online(const void *owner_table, const char *table_type, const char *node_id, uint32_t timeout_ms)</div><div class="ttdoc">Check if a device is currently online (owner role only).</div></div>
<div class="ttc" id="agroup__owner__helpers_html_gaf3bc5a746b96a07e311c4c24feb94127"><div class="ttname"><a href="#gaf3bc5a746b96a07e311c4c24feb94127">sds_get_liveness_interval</a></div><div class="ttdeci">uint32_t sds_get_liveness_interval(const char *table_type)</div><div class="ttdoc">Get the liveness interval for a table type.</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">owner_table</td><td>Pointer to owner table structure </td></tr>
    <tr><td class="paramname">table_type</td><td>Table type name </td></tr>
    <tr><td class="paramname">node_id</td><td>Device node ID to check </td></tr>
    <tr><td class="paramname">timeout_ms</td><td>Liveness timeout (typically 1.5x the liveness interval) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if device is online</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#gaf3bc5a746b96a07e311c4c24feb94127" title="Get the liveness interval for a table type.">sds_get_liveness_interval</a> </dd></dl>

</div>
</div>
<a id="gaa960005296d3c78a174f8ff2031719fa" name="gaa960005296d3c78a174f8ff2031719fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa960005296d3c78a174f8ff2031719fa">&#9670;&#160;</a></span>sds_on_device_evicted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sds_on_device_evicted </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__callbacks.html#ga1620244dfc15a6423fe29b7d9c3edc3e">SdsDeviceEvictedCallback</a></td>          <td class="paramname"><span class="paramname"><em>callback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>user_data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set global callback for device eviction notifications. </p>
<p>Called when a device is evicted from any status table after the eviction grace period expires following an LWT message. Since eviction is global (one grace period for all tables), this callback is invoked once per table that the device was registered in.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> on_device_evicted(<span class="keyword">const</span> <span class="keywordtype">char</span>* table_type, <span class="keyword">const</span> <span class="keywordtype">char</span>* node_id, <span class="keywordtype">void</span>* user_data) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Device %s was evicted from %s\n&quot;</span>, node_id, table_type);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// table_type parameter is ignored (global callback)</span></div>
<div class="line"><a class="code hl_function" href="#gaa960005296d3c78a174f8ff2031719fa">sds_on_device_evicted</a>(NULL, on_device_evicted, NULL);</div>
<div class="ttc" id="agroup__owner__helpers_html_gaa960005296d3c78a174f8ff2031719fa"><div class="ttname"><a href="#gaa960005296d3c78a174f8ff2031719fa">sds_on_device_evicted</a></div><div class="ttdeci">void sds_on_device_evicted(const char *table_type, SdsDeviceEvictedCallback callback, void *user_data)</div><div class="ttdoc">Set global callback for device eviction notifications.</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table_type</td><td>Ignored (kept for backward compatibility) </td></tr>
    <tr><td class="paramname">callback</td><td>Function to call on eviction </td></tr>
    <tr><td class="paramname">user_data</td><td>User context passed to callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__callbacks.html#ga1620244dfc15a6423fe29b7d9c3edc3e" title="Callback for device eviction (owner role only).">SdsDeviceEvictedCallback</a>, <a class="el" href="struct_sds_config.html#a2bbfb685e4fd026e7be87e0f9352583f">SdsConfig::eviction_grace_ms</a> </dd></dl>

</div>
</div>
<a id="gabad46d1e7d411b2b7773e0248651fd5b" name="gabad46d1e7d411b2b7773e0248651fd5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabad46d1e7d411b2b7773e0248651fd5b">&#9670;&#160;</a></span>sds_set_owner_eviction_offsets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sds_set_owner_eviction_offsets </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>eviction_pending_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>eviction_deadline_offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure eviction slot offsets for an owner table. </p>
<p>This function configures the slot field offsets needed for eviction tracking. The eviction grace period is set globally via <a class="el" href="struct_sds_config.html#a2bbfb685e4fd026e7be87e0f9352583f">SdsConfig.eviction_grace_ms</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// After sds_set_owner_slot_offsets():</span></div>
<div class="line"><a class="code hl_function" href="#gabad46d1e7d411b2b7773e0248651fd5b">sds_set_owner_eviction_offsets</a>(</div>
<div class="line">    <span class="stringliteral">&quot;SensorData&quot;</span>,</div>
<div class="line">    offsetof(SensorDataStatusSlot, eviction_pending),</div>
<div class="line">    offsetof(SensorDataStatusSlot, eviction_deadline)</div>
<div class="line">);</div>
<div class="ttc" id="agroup__owner__helpers_html_gabad46d1e7d411b2b7773e0248651fd5b"><div class="ttname"><a href="#gabad46d1e7d411b2b7773e0248651fd5b">sds_set_owner_eviction_offsets</a></div><div class="ttdeci">void sds_set_owner_eviction_offsets(const char *table_type, size_t eviction_pending_offset, size_t eviction_deadline_offset)</div><div class="ttdoc">Configure eviction slot offsets for an owner table.</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table_type</td><td>Table type name </td></tr>
    <tr><td class="paramname">eviction_pending_offset</td><td>offsetof(StatusSlot, eviction_pending) </td></tr>
    <tr><td class="paramname">eviction_deadline_offset</td><td>offsetof(StatusSlot, eviction_deadline)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The eviction grace period is configured in <a class="el" href="struct_sds_config.html" title="Configuration for SDS initialization.">SdsConfig</a>, not per-table.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="struct_sds_config.html#a2bbfb685e4fd026e7be87e0f9352583f">SdsConfig::eviction_grace_ms</a> </dd>
<dd>
<a class="el" href="#gaa960005296d3c78a174f8ff2031719fa" title="Set global callback for device eviction notifications.">sds_on_device_evicted</a> </dd></dl>

</div>
</div>
<a id="ga1f5ee7f7b53a65c266dee0a967683dd1" name="ga1f5ee7f7b53a65c266dee0a967683dd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1f5ee7f7b53a65c266dee0a967683dd1">&#9670;&#160;</a></span>sds_set_owner_slot_offsets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sds_set_owner_slot_offsets </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>valid_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>online_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>last_seen_offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure slot field offsets for online detection (owner role only). </p>
<p>This function sets the offsets of the valid, online, and last_seen_ms fields within each status slot. Required for <a class="el" href="#gae142a1929b1869cff9059e48b9d29d58" title="Check if a device is currently online (owner role only).">sds_is_device_online()</a> to work.</p>
<div class="fragment"><div class="line"><span class="comment">// After sds_set_owner_status_slots():</span></div>
<div class="line"><a class="code hl_function" href="#ga1f5ee7f7b53a65c266dee0a967683dd1">sds_set_owner_slot_offsets</a>(</div>
<div class="line">    <span class="stringliteral">&quot;SensorData&quot;</span>,</div>
<div class="line">    offsetof(SensorDataStatusSlot, valid),</div>
<div class="line">    offsetof(SensorDataStatusSlot, online),</div>
<div class="line">    offsetof(SensorDataStatusSlot, last_seen_ms)</div>
<div class="line">);</div>
<div class="ttc" id="agroup__owner__helpers_html_ga1f5ee7f7b53a65c266dee0a967683dd1"><div class="ttname"><a href="#ga1f5ee7f7b53a65c266dee0a967683dd1">sds_set_owner_slot_offsets</a></div><div class="ttdeci">void sds_set_owner_slot_offsets(const char *table_type, size_t valid_offset, size_t online_offset, size_t last_seen_offset)</div><div class="ttdoc">Configure slot field offsets for online detection (owner role only).</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table_type</td><td>Table type name </td></tr>
    <tr><td class="paramname">valid_offset</td><td>offsetof(StatusSlot, valid) </td></tr>
    <tr><td class="paramname">online_offset</td><td>offsetof(StatusSlot, online) </td></tr>
    <tr><td class="paramname">last_seen_offset</td><td>offsetof(StatusSlot, last_seen_ms)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga123fbc786143c83795b09d8332e18f71" title="Configure status slot metadata for manual table registration.">sds_set_owner_status_slots</a> </dd>
<dd>
<a class="el" href="#gae142a1929b1869cff9059e48b9d29d58" title="Check if a device is currently online (owner role only).">sds_is_device_online</a> </dd></dl>

</div>
</div>
<a id="ga123fbc786143c83795b09d8332e18f71" name="ga123fbc786143c83795b09d8332e18f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga123fbc786143c83795b09d8332e18f71">&#9670;&#160;</a></span>sds_set_owner_status_slots()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sds_set_owner_status_slots </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>table_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>slots_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>slot_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>slot_status_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>count_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>max_slots</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure status slot metadata for manual table registration. </p>
<p>When using <a class="el" href="group__registration.html#ga62bff7a0359b6f6329224560ed2dec69">sds_register_table_ex()</a> directly (not via codegen registry), call this function to enable per-device status tracking for owner tables.</p>
<dl class="section note"><dt>Note</dt><dd>This is not needed when using <a class="el" href="group__registration.html#ga0ecdb264b6ba8215cd48675e50dcbbe4" title="Register a table using the metadata registry.">sds_register_table()</a> with generated code.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table_type</td><td>Table type name </td></tr>
    <tr><td class="paramname">slots_offset</td><td>offsetof(OwnerTable, status_slots) </td></tr>
    <tr><td class="paramname">slot_size</td><td>sizeof(StatusSlot) </td></tr>
    <tr><td class="paramname">slot_status_offset</td><td>offsetof(StatusSlot, status) </td></tr>
    <tr><td class="paramname">count_offset</td><td>offsetof(OwnerTable, status_count) </td></tr>
    <tr><td class="paramname">max_slots</td><td>Maximum number of device slots</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__registration.html#ga62bff7a0359b6f6329224560ed2dec69">sds_register_table_ex</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
